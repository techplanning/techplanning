<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <style>
        .header{
            width: 100%;
            height: 100px;
            border: 1px solid red;
        }
        .header_logo{
            position : relative;
            display: inline-block;
        }
        .header_menu{
            display: inline-block;
        }
        .header_menu div{
            display: inline-block;
        }
        .header_status{
            display: inline-block;
        }
        .home_banner{
            width: 100%;
            height: 250px;
            border: 1px solid purple;
        }
        .home_guide{
            display: inline-block;
            border: 1px solid blue;
        }
        .home_notice{
            display: inline-block;
            border: 1px solid green;
        }
        .menu1{
            border : 3px solid forestgreen;
            display : none;

        }
        #loading {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            -webkit-animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { -webkit-transform: rotate(360deg); }
        }
        @-webkit-keyframes spin {
            to { -webkit-transform: rotate(360deg); }
        }
        #on_status_box{
            margin : 20px 20px 20px 20px;
            border-radius : 5px;
            background-color : darkgrey;
            color: white;
            text-align : center;
        }
        #load_finished_box{
            display : none;
            background-color : darkorange;
        }
        .icon-smile {
            background-color: #000;
            border-radius:8px;
            -webkit-border-radius:8px;
            -moz-border-radius:8px;
            width: 16px;
            height: 16px;
            position: relative;
            top:0;
            left:0;
        }
        .icon-smile:after {
            background-color: #fff;
            -webkit-border-radius: 2px;
            -moz-border-radius: 2px;
            width: 2px;
            height: 3px;
            position: absolute;
            top: 4px;
            left: 4px;
            content: "";
        }
        .icon-smile:before {
            background-color: #fff;
            -webkit-border-radius: 2px;
            -moz-border-radius: 2px;
            width: 2px;
            height: 3px;
            position: absolute;
            top: 4px;
            left: 10px;
            content: "";
        }
        .icon-smile-line {
            background-color: #fff;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
            -webkit-border-bottom-left-radius: 8px;
            -webkit-border-bottom-right-radius: 8px;
            -moz-border-radius-bottomleft: 8px;
            -moz-border-radius-bottomright: 8px;
            width: 8px;
            height: 3px;
            position: absolute;
            top: 9px;
            left: 4px;
        }

        .icon-smile .icon-smile-line {
            -webkit-transition-property: -webkit-border-bottom-left-radius, -webkit-border-bottom-right-radius, -webkit-border-top-left-radius, -webkit-border-top-right-radius;
            -webkit-transition-duration: 0.333s;
            -webkit-transition-timing-function: linear;
            -moz-transition-property: -moz-border-radius-bottomleft, -moz-border-radius-bottomright, -moz-border-radius-topleft, -moz-border-radius-topright;
            -moz-transition-duration: 0.333s;
            -moz-transition-delay: 0;
            -moz-transition-timing-function: linear;
        }
        .icon-smile:hover .icon-smile-line {
            -webkit-border-bottom-left-radius: 0;
            -webkit-border-bottom-right-radius: 0;
            -webkit-border-top-left-radius: 8px;
            -webkit-border-top-right-radius: 8px;
            -moz-border-radius-bottomleft: 0;
            -moz-border-radius-bottomright: 0;
            -moz-border-radius-topleft: 8px;
            -moz-border-radius-topright: 8px;
        }
        .loading_2 {
            width: 70px;
            height: 50px;
            position: relative;
            margin: 50px auto;
        }
        .loading_2 span {
            display: block;
            position: absolute;
            bottom: 0;
            width: 10px;
            height: 5px;
            background-color: #ea834c;
            animation: waving 1.5s  infinite ease-in-out;
            -webkit-animation: waving 1.5s  infinite ease-in-out;
            -moz-animation: waving 1.5s  infinite ease-in-out;
            -o-animation: waving 1.5s  infinite ease-in-out;
        }
        .loading span:nth-of-type(2) {
            left:11px;
            animation-delay: .2s;
            -webkit-animation-delay: .2s;
            -moz-animation-delay: .2s;
            -o-animation-delay: .2s;
        }
        .loading span:nth-of-type(3) {
            left:22px;
            animation-delay: .4s;
            -webkit-animation-delay: .4s;
            -moz-animation-delay: .4s;
            -o-animation-delay: .4s;
        }
        .loading span:nth-of-type(4) {
            left:33px;
            animation-delay: .6s;
            -webkit-animation-delay: .6s;
            -moz-animation-delay: .6s;
            -o-animation-delay: .6s;
        }
        .loading span:nth-of-type(5) {
            left:44px;
            animation-delay: .8s;
            -webkit-animation-delay: .8s;
            -moz-animation-delay: .8s;
            -o-animation-delay: .8s;
        }
        .loading span:last-of-type {
            left:55px;
            animation-delay: 1s;
            -webkit-animation-delay: 1s;
            -moz-animation-delay: 1s;
            -o-animation-delay: 1s;
        }
        @keyframes waving {
            0% , 50% , 100%{
                height: 5px;
                transform: translateY(0px);
                -webkit-transform: translateY(0px);
                -moz-transform: translateY(0px);
                -o-transform: translateY(0px);
                background-color: #ea834c;
            }
            25%{
                height: 60px;
                transform: translateY(15px);
                -webkit-transform: translateY(15px);
                -moz-transform: translateY(15px);
                -o-transform: translateY(15px);
                background-color: #ea4c4c;
            }
        }
        @-webkit-keyframes waving {
            0% , 50% , 100%{
                height: 5px;
                transform: translateY(0px);
                -webkit-transform: translateY(0px);
                -moz-transform: translateY(0px);
                -o-transform: translateY(0px);
                background-color: #ea834c;
            }
            25%{
                height: 60px;
                transform: translateY(15px);
                -webkit-transform: translateY(15px);
                -moz-transform: translateY(15px);
                -o-transform: translateY(15px);
                background-color: #ea4c4c;
            }
        }
        @-moz-keyframes waving {
            0% , 50% , 100%{
                height: 5px;
                transform: translateY(0px);
                -webkit-transform: translateY(0px);
                -moz-transform: translateY(0px);
                -o-transform: translateY(0px);
                background-color: #ea834c;
            }
            25%{
                height: 60px;
                transform: translateY(15px);
                -webkit-transform: translateY(15px);
                -moz-transform: translateY(15px);
                -o-transform: translateY(15px);
                background-color: #ea4c4c;
            }
        }
        @-o-keyframes waving {
            0% , 50% , 100%{
                height: 5px;
                transform: translateY(0px);
                -webkit-transform: translateY(0px);
                -moz-transform: translateY(0px);
                -o-transform: translateY(0px);
                background-color: #ea834c;
            }
            25%{
                height: 60px;
                transform: translateY(15px);
                -webkit-transform: translateY(15px);
                -moz-transform: translateY(15px);
                -o-transform: translateY(15px);
                background-color: #ea4c4c;
            }
        }
        #definition_list{
            background_color: #FABEBE;
        }
        #loading_error{
            display : none;
        }
        #definition_finished_box{
            background: greenyellow;
        }
        .menu2{
            border : 3px solid palevioletred;
            display : none;
        }
        .menu3{
            border : 3px solid skyblue;
            display : none;
        }
        .footer{
            align-content : center;
            position: fixed;
            bottom: 0;
            width : 100%;
        }
        .footer ul{
            list-style-type: none;
            text-align: center;
        }
        .footer ul li{
            display: inline-block;
            width: 100px;
            height: 100px;
            text-align: center;
            margin-right: 80px;
            padding-bottom: 10px;
            opacity: 0.5;
        }
        @keyframes menu_hovering{
            from {
                opacity: 0.5;
            }
            to {
                opacity: 1;
            }
        }
        .footer ul li:hover{
            padding-bottom : 8px;
            -webkit-animation-name: menu_hovering;
            animation-name: menu_hovering;
            -o-animation-name: menu_hovering;
            -moz-animation-duration: 1s;
            -o-animation-duration: 1s;
            -webkit-animation-duration: 1s;
            -moz-animation-duration: 1s;
            -o-animation-duration: 1s;
        }
        .footer a img{
            width: 80px;
            height: 80px;
        }
    </style>
    <title>Title</title>
</head>
<body>
<div class="header">
    <div class="header_logo">
        <a href="home.html">
            Reindeer
        </a>
    </div>
    <div class="header_status">
        <button id="authorize-button" style="display: none;">Authorize</button>
        <button id="signout-button" style="display: none;">Sign Out</button>
    </div>
</div>
<div class="home">
    <div class="home_banner">
        배너 영역
    </div>
    <div class="home_guide">
        <div class="home_guide_banner">
            사용 가이드>
        </div>
        <div class="home_guide_contents">
            <ul>
                <li><a>공지1</a></li>
                <li><a>공지2</a></li>
                <li><a>공지3</a></li>
            </ul>
        </div>
    </div>
    <div class="home_notice">
        <div class="home_notice_banner">
            공지사항>
        </div>
        <div class="home_notice_contents">
            <ul>
                <li><a>공지1</a></li>
                <li><a>공지2</a></li>
                <li><a>공지3</a></li>
            </ul>
        </div>
    </div>
</div>
<div class="menu1">
    <div id = "on_status_box">
        <div id="loading"></div>
        <pre id="on_status"></pre>
    </div>
    <div id = "load_finished_box">
        <div class="icon icon-smile">
            <div class="icon-smile-line"></div>
        </div>
        <pre id="load_finished"></pre>
    </div>
    <div id = "definition_list_box">
        <pre id="on_status_definition_list_check"></pre>
    </div>
    <div id = "definition_finished_box">
        <pre id="definition_finished"></pre>
    </div>
    <div id = "loading_error">

    </div>
    <pre id="log"></pre>
</div>
<div class="menu2">
    Menu2
</div>
<div class="menu3">
    Menu3
</div>
<div class="footer">
    <ul>
        <li>
            <a href="#" id="menu1_btn" onclick="menu1_vi();"><img src="menu1_icon.png"/><br>정의서 검사</a>
        </li>
        <li>
            <a href="#" id="menu2_btn" onclick="menu2_vi();"><img src="menu2_icon.png"/><br>QA 검사</a>
        </li>
        <li>
            <a href="#" id="menu3_btn" onclick="menu3_vi();"><img src="menu3_icon.png"/><br>메뉴3</a>
        </li>
    </ul>
</div>
<script type="text/javascript">
    function menu1_vi() {
        document.getElementsByClassName("menu1")[0].style.display = "block";
        document.getElementsByClassName("menu2")[0].style.display = "none";
        document.getElementsByClassName("menu3")[0].style.display = "none";
        document.getElementsByClassName("home")[0].style.display = "none";

        function load_finished(message, status) {

        }

        function loading_appneder(message, status) {
            var loading_message = document.getElementById(status);
            loading_message.style.display = "block";
            var msg = document.createTextNode(message + "\n");
            loading_message.appendChild(msg);
        }

        function appendPre(message) {
            var pre = document.getElementById('log');
            var textContent = document.createTextNode(message + "\n");
            pre.appendChild(textContent);
        }

        /**
         * Load Sheets API client library.
         */
        var _ALL = 0, _TRACE = 1, _DEBUG = 2, _INFO = 3, _WARN = 4, _ERROR = 5, _FATAL = 6, _OFF = 7;
        var _logLevelNm = ["[ALL]", "[TRACE]", "[DEBUG]", "[INFO]", "[WARN]", "[ERROR]", "[FATAL]", "[OFF]"];
        var _logLevel = _WARN;

        function log(logLevel, code, message, infoObj, targetInfoObj) {
            if (logLevel >= _logLevel) {
                logMsg = _logLevelNm[logLevel] + " " + code + " - " + message;
                if (infoObj) logMsg = logMsg + "\n\t(처리대상 : " + JSON.stringify(infoObj) + ")"
                if (targetInfoObj) logMsg = logMsg + "\n\t(비교대상 : " + JSON.stringify(targetInfoObj) + ")"
                appendPre(logMsg);
            }
        }

        var _PROC = 0, _NOTI = 1, _SYSTEM = 2;
        var _tagLevelNm = ["[PROCESS]", "[NOTI]", "[SYSTEM]"];
        var _tagLevel = _PROC;

        function msg(tag, message, infoObj, responseObj) {
            if (tag >= _tagLevel) {
                var msg = message;

                if (tag > _NOTI) msg = _tagLevelNm[tag] + " " + msg;
                if (infoObj) msg = msg + "\t(" + JSON.stringify(infoObj) + ")";
                appendPre(msg);
                if (tag > _NOTI) console.error(msg, responseObj);
            }
        }

        var _defList = [];
        var _sheet = [];
        var _sheetMap = {};
        readDefinitionList();

        function readDefinitionList() {
            var spreadsheetId = '18HiiJG-Utm6e-wXr2Ie_z_8TtlBwq3yPFLjf8v45F-Q';
            var spreadsheetTitle = 'PageID_11번가 Log 2.0';
            var sheetTitle = ['모바일 v.2.3', 'PC v.2.1'];
            loading_appneder("\"" + spreadsheetTitle + "\" 스프레드 시트를 로딩하고 있습니다", "on_status");
            var params = {
                spreadsheetId: [spreadsheetId],
                ranges: [
                    sheetTitle[0] + '!N2:O',
                    sheetTitle[1] + '!M2:N'
                ]
            };
            gapi.client.sheets.spreadsheets.values.batchGet(params).then(function (response) {
                var valueRanges = response.result.valueRanges;
                var sheetSize = valueRanges.length;
                var poc = ['MW', 'PC'];
                if (sheetSize == sheetTitle.length) {
                    for (s = 0; s < sheetSize; s++) {
                        loading_appneder("\"" + sheetTitle[s] + "\" 시트를 로딩하고 있습니다.", "on_status");
                        var range = valueRanges[s];
                        if (range.values.length > 0) {
                            var rowSize = range.values.length;
                            var data = [];
                            for (r = 1; r < rowSize; r++) {
                                if (range.values[r]) {
                                    data[r - 1] = {};
                                    data[r - 1]["poc"] = poc[s];
                                    data[r - 1]["no"] = r;
                                    var colSize = range.values[r].length;
                                    for (c = 0; c < colSize; c++) {
                                        data[r - 1][range.values[0][c]] = range.values[r][c];
                                    }
                                    if (data[r - 1]["로그정의서 링크URL"]) {
                                        var regEx1 = /spreadsheets\/d\/([a-zA-Z0-9-_]+)/.exec(data[r - 1]["로그정의서 링크URL"]);
                                        if (regEx1 && regEx1.length > 0) {
                                            data[r - 1]["spreadsheetId"] = regEx1[1];
                                        }
                                        var regEx2 = /[#&]gid=([0-9]+)/.exec(data[r - 1]["로그정의서 링크URL"])
                                        if (regEx2 && regEx2.length > 0) {
                                            data[r - 1]["sheetId"] = regEx2[1];
                                        }
                                    }
                                }
                            }
                            _defList = _defList.concat(data);
                            loading_appneder("\"" + sheetTitle[s] + "\" 시트 로딩이 완료되었습니다.", "on_status");
                        } else {
                            msg(_SYSTEM, "시트 로딩 오류 - No data found.", {
                                spreadsheetTitle: [spreadsheetTitle],
                                sheetTitle: [sheetTitle[s]]
                            }, response);
                        }
                    }
                    document.getElementById('on_status_box').style.display = "none";
                    document.getElementById('load_finished_box').style.display = "block";
                    loading_appneder("시트 로딩 완료", "load_finished");
                    loading_appneder("현재 로딩된 시트" + spreadsheetTitle + " > " + sheetTitle, "load_finished");
                    checkDefList(spreadsheetTitle);
                    loadSheets();
                } else {
                    msg(_SYSTEM, "시트 처리 오류 - POC별 시트 로딩 실패.", {spreadsheetTitle: [spreadsheetTitle]}, response);
                }
            }, function (response) {
                msg(_SYSTEM, "시트 처리 오류 - " + response.result.error.message, {spreadsheetTitle: [spreadsheetTitle]}, response);
            });
        }

        function loadSheets() {
        }

        function checkDefList(spreadsheetTitle) {
            
            loading_appneder("로그 정의서 내역 검증중", "on_status_definition_list_check");

            var defSize = _defList.length;
            for (d = 0; d < defSize; d++) {
                var info = _defList[d];
                info.spreadsheetTitle = spreadsheetTitle;
                // 빈 값 체크
                if (!info["로그정의서명"]) {
                    log(_DEBUG, "0001", "\"로그정의서명\"이 없습니다.", info);
                } else if (!/^\[로그정의서\] .*$/.test(info["로그정의서명"])) {
                    log(_ERROR, "0005", "\"로그정의서명\"서식이 올바르지 않습니다.", info);
                }
                if (!info["로그정의서 링크URL"]) {
                    log(_DEBUG, "0002", "\"로그정의서 링크URL\"이 없습니다.", info);
                } else {
                    if (!info["spreadsheetId"]) {
                        log(_ERROR, "0003", "\"시트파일ID\"가 없습니다.", info);
                    } else {
                        if (!info["sheetId"]) {
                            log(_ERROR, "0004", "\"로그정의서 링크URL\"이 파일에 대한 링크로, 시트에 대한 링크가 아닙니다.", info);
                        }
                    }
                }
                // 중복체크
                if (info["spreadsheetId"]) {
                    if (_sheetMap[info["spreadsheetId"]]) {
                        var targetInfo = _sheetMap[info["spreadsheetId"]];
                        if (info["poc"] == targetInfo["poc"]) {
                            log(_ERROR, "0009", "동일한 POC에 중복된 정의서 링크가 있습니다.", info, targetInfo);
                        } else {
                            log(_INFO, "0006", "중복된 정의서 링크가 있습니다.", info, targetInfo);
                        }
                        if (targetInfo["로그정의서명"] != info["로그정의서명"]) {
                            log(_ERROR, "0008", "\"로그정의서명\"이 다른 중복된 정의서 링크가 있습니다.", info, targetInfo);
                        }
                        if (info["sheetId"] && targetInfo["sheetId"] == info["sheetId"]) {
                            log(_ERROR, "0007", "중복된 정의서 시트 링크가 있습니다.", info, targetInfo);
                        }
                    } else {
                        _sheetMap[info["spreadsheetId"]] = info
                    }
                }
            }
            document.getElementById('definition_list_box').style.display = "none";
            loading_appneder("로그 정의서 내용 검증 완료", "definition_finished");
        }
    }

    function menu2_vi(){
        document.getElementsByClassName("menu1")[0].style.display = "none";
        document.getElementsByClassName("menu2")[0].style.display = "block";
        document.getElementsByClassName("menu3")[0].style.display = "none";
        document.getElementsByClassName("home")[0].style.display = "none";
    }
    function menu3_vi(){
        document.getElementsByClassName("menu1")[0].style.display = "none";
        document.getElementsByClassName("menu2")[0].style.display = "none";
        document.getElementsByClassName("menu3")[0].style.display = "block";
        document.getElementsByClassName("home")[0].style.display = "none";
    }
</script>
<script>
    // Client ID and API key from the Developer Console
    var CLIENT_ID = '696566559550-7rge69rqjpck7nup7dkfa0tt5huqusi0.apps.googleusercontent.com';
    // Array of API discovery doc URLs for APIs used by the quickstart
    var DISCOVERY_DOCS = ["https://www.googleapis.com/discovery/v1/apis/sheets/v4/rest"];
    // Authorization scopes required by the API; multiple scopes can be
    // included, separated by spaces.
    var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";
    var authorizeButton = document.getElementById('authorize-button');
    var signoutButton = document.getElementById('signout-button');
    /**
     *  On load, called to load the auth2 library and API client library.
     */
    function handleClientLoad() {
        gapi.load('client:auth2', initClient);
    }
    /**
     *  Initializes the API client library and sets up sign-in state
     *  listeners.
     */
    function initClient() {
        gapi.client.init({
            discoveryDocs: DISCOVERY_DOCS,
            clientId: CLIENT_ID,
            scope: SCOPES
        }).then(function () {
            // Listen for sign-in state changes.
            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
            // Handle the initial sign-in state.
            updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            authorizeButton.onclick = handleAuthClick;
            signoutButton.onclick = handleSignoutClick;
        });
    }
    /**
     *  Called when the signed in status changes, to update the UI
     *  appropriately. After a sign-in, the API is called.
     */
    function loadSheetsApi() {
        var discoveryUrl =
            'https://sheets.googleapis.com/$discovery/rest?version=v4';
        gapi.client.load(discoveryUrl);
    }
    function updateSigninStatus(isSignedIn) {
        if (isSignedIn) {
            authorizeButton.style.display = 'none';
            signoutButton.style.display = 'block';
            loadSheetsApi();
        } else {
            authorizeButton.style.display = 'block';
            signoutButton.style.display = 'none';
        }
    }
    /**
     *  Sign in the user upon button click.
     */
    function handleAuthClick(event) {
        gapi.auth2.getAuthInstance().signIn();
    }
    /**
     *  Sign out the user upon button click.
     */
    function handleSignoutClick(event) {
        gapi.auth2.getAuthInstance().signOut();
    }
    /**
     * Append a pre element to the body containing the given message
     * as its text node. Used to display the results of the API call.
     *
     * @param {string} message Text to be placed in pre element.
     */
</script>
<script async defer src="https://apis.google.com/js/api.js"
        onload="this.onload=function(){};handleClientLoad()"
        onreadystatechange="if (this.readyState === 'complete') this.onload()">
</script>
</body>
</html>
